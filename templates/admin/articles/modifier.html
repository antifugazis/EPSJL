{% extends "admin/base_admin.html" %}

{% block title %}Modifier Article - Administration{% endblock %}

{% block content %}
<div class="p-6 space-y-6">
    <!-- En-tête -->
    <div class="flex items-center gap-4">
        <a href="{{ url_for('articles.admin_liste') }}" 
           class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
        </a>
        <div>
            <h1 class="text-3xl font-bold text-gray-800">Modifier l'Article</h1>
            <p class="text-gray-600 mt-1">{{ article.titre }}</p>
        </div>
    </div>

    <!-- Formulaire -->
    <div class="bg-white rounded-xl shadow-lg p-8">
        <form method="POST" action="{{ url_for('articles.admin_modifier', article_id=article.id) }}" enctype="multipart/form-data" class="space-y-6">
            <!-- Titre -->
            <div>
                <label for="titre" class="block text-sm font-medium text-gray-700 mb-2">
                    Titre de l'article <span class="text-red-500">*</span>
                </label>
                <input type="text" id="titre" name="titre" required maxlength="200" value="{{ article.titre }}"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- Description courte -->
            <div>
                <label for="description_courte" class="block text-sm font-medium text-gray-700 mb-2">
                    Description courte
                </label>
                <textarea id="description_courte" name="description_courte" rows="3" maxlength="500"
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                          placeholder="Résumé de l'article (affiché dans la liste)">{{ article.description_courte or '' }}</textarea>
                <p class="text-xs text-gray-500 mt-1">Maximum 500 caractères</p>
            </div>

            <!-- Contenu -->
            <div>
                <label for="contenu" class="block text-sm font-medium text-gray-700 mb-2">
                    Contenu de l'article <span class="text-red-500">*</span>
                </label>
                <textarea id="contenu" name="contenu" rows="10" required
                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                          placeholder="Contenu complet de l'article">{{ article.contenu }}</textarea>
            </div>

            <!-- Image de couverture actuelle -->
            {% if article.image_couverture %}
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Image actuelle</label>
                <div class="w-64 h-40 rounded-lg overflow-hidden border border-gray-200">
                    <img src="/{{ article.image_couverture }}" alt="{{ article.titre }}" class="w-full h-full object-cover">
                </div>
            </div>
            {% endif %}

            <!-- Nouvelle image de couverture -->
            <div>
                <label for="image_couverture" class="block text-sm font-medium text-gray-700 mb-2">
                    {% if article.image_couverture %}Changer l'image de couverture{% else %}Image de couverture{% endif %}
                </label>
                <input type="file" id="image_couverture" name="image_couverture" accept="image/*"
                       class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                <p class="text-xs text-gray-500 mt-1">Formats acceptés: JPG, PNG, GIF, WEBP</p>
            </div>

            <!-- Catégorie -->
            <div>
                <label for="categorie" class="block text-sm font-medium text-gray-700 mb-2">
                    Catégorie <span class="text-red-500">*</span>
                </label>
                <select id="categorie" name="categorie" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Sélectionnez une catégorie</option>
                    <option value="vie-scolaire" {% if article.categorie == 'vie-scolaire' %}selected{% endif %}>Vie scolaire</option>
                    <option value="annonces" {% if article.categorie == 'annonces' %}selected{% endif %}>Annonces officielles</option>
                    <option value="culture" {% if article.categorie == 'culture' %}selected{% endif %}>Culture et foi</option>
                    <option value="celebrations" {% if article.categorie == 'celebrations' %}selected{% endif %}>Célébrations religieuses</option>
                </select>
            </div>

            <!-- Date de l'événement -->
            <div>
                <label for="date_evenement" class="block text-sm font-medium text-gray-700 mb-2">
                    Date de l'événement
                </label>
                <input type="date" id="date_evenement" name="date_evenement" 
                       value="{{ article.date_evenement.strftime('%Y-%m-%d') if article.date_evenement else '' }}"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- Actif -->
            <div class="flex items-center">
                <input type="checkbox" id="actif" name="actif" {% if article.actif %}checked{% endif %}
                       class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                <label for="actif" class="ml-3 text-sm font-medium text-gray-700">
                    Article actif (visible sur le site)
                </label>
            </div>

            <!-- Boutons -->
            <div class="flex gap-4 pt-4">
                <button type="submit"
                        class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    Enregistrer les modifications
                </button>
                <a href="{{ url_for('articles.admin_liste') }}"
                   class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                    Annuler
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
